apiVersion: nais.io/v1
kind: Naisjob
metadata:
  name: dp-arena-trakt
  namespace: teamdagpenger
  labels:
    team: teamdagpenger
spec:
  image: {{image}}
  parallelism: {{parallelism}}
  command:
    - jobb
  resources:
    limits:
      cpu: 300m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 256Mi
  secureLogs:
    enabled: true
  kafka:
    pool: {{kafka_pool}}
  envFrom:
    - secret: google-sql-dp-arena-trakt-arena-data-job-51e3c035
  gcp:
    permissions:
      - resource:
          apiVersion: resourcemanager.cnrm.cloud.google.com/v1beta1
          kind: Project
        role: roles/cloudsql.client